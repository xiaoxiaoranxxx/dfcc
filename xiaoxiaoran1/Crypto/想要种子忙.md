# bugku 想要种子吗

![torrent](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/torrent.jpg)

## 先看看图片属性

![image-20210918160604301](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918160604301.png)

发现隐藏关键信息。STEGHIDE。这是一种图片隐写方法。

在kali系统上安装STEGHIDE工具。安装步骤如下

```php
 apt install steghide
```

查看图片中嵌入的文件信息

```php
steghide info filename
```

隐藏文件

```php
steghide embed -cf coverfile -ef embedfile
```

提取文件

```sh
steghide extract -sf STEGOFILE
```

## 提取文件

```
steghide info torrent.jpg 
steghide extract -sf  torrent.jpg      
```

![image-20210918161637967](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918161637967.png)

## 打开123.txt，发现一个百度网盘地址

里面是一个某网盘的链接和密码。得到一个压缩包文件，有密码

hit里面six six six联想到应该是六位数密码。爆破一下得到密码

![image-20210918162032762](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918162032762.png)

## 得到如下图片

![123](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/123.png)

## 010 editor编辑器里看看

![image-20210918162730495](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918162730495.png)

## 发现有504B0304开头，有压缩包，应该是文件包含

```
binwalk -e 123.png
```

![image-20210918163439973](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918163439973.png)

## 打开flag.png文件加载失败

![image-20210918164053120](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918164053120.png)

再拖到010 editor编辑器里看看，看看有crc报错，一般这种都是高度有问题

## 脚本跑一下得到尺寸

```python
import zlib
import struct

filename = 'flag.png'
with open(filename, 'rb') as f:
    all_b = f.read()
    crc32key = int(all_b[29:33].hex(),16)
    data = bytearray(all_b[12:29])
    n = 4095            #理论上0xffffffff,但考虑到屏幕实际/cpu，0x0fff就差不多了
    for w in range(n):          #高和宽一起爆破
        width = bytearray(struct.pack('>i', w))     #q为8字节，i为4字节，h为2字节
        for h in range(n):
            height = bytearray(struct.pack('>i', h))
            for x in range(4):
                data[x+4] = width[x]
                data[x+8] = height[x]
            crc32result = zlib.crc32(data)
            if crc32result == crc32key:
                print("宽为：",end="")
                print(width)
                print("高为：",end="")
                print(height)
                exit(0)

```

## 结果

![image-20210918164509338](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918164509338.png)

## 更改前后

![image-20210918165351572](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918165351572.png)

![image-20210918165334172](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918165334172.png)

## flag.png末尾提示网址

![image-20210918165602022](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918165602022.png)



[维吉尼亚密码网站](https://www.guballa.de/vigenere-solver)

## flag.png打开

![image-20210918165749357](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918165749357.png)

```
fkyg{SfirgsXmuqRoqpemr}
```

维吉尼亚解密。常规网站解密是需要密钥的，但是提示给的网站可以枚举。

![image-20210918165941997](https://xiuxiu-1306082599.cos.ap-beijing.myqcloud.com/xiao/image-20210918165941997.png)

```
flag{ThisisYourTorrent}
```

